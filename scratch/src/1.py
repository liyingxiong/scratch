'''
Created on Jan 14, 2015

@author: Li Yingxiong
'''
import numpy as np
from scipy.optimize import newton
from scipy.interpolate import interp1d
from matplotlib import pyplot as plt
from stats.misc.random_field.random_field_1D import RandomField
import os

# #m=6
# a1 = np.array([3.1728813559322036, 3.020768073373788, 2.5695515291096203, 2.4376991389970266, 2.409790828137902, 2.0792176527466495, 2.4532489465286984, 2.9206192507903745])
# a2 = np.array([3.4224105461393597, 3.5597257572371657, 2.9874366727461314, 2.716326037059809, 3.3083020336473656, 2.3926444452779556])
# a3 = np.array([2.2104990583804143, 2.431046706745228, 2.521780632368864, 2.5961895124332655, 2.343796699510126, 2.403758628020471, 2.544902988832734])
# a4 = np.array([3.3416195856873823, 3.0182080417515897, 3.431653778439758, 2.8768728403163735, 2.6445886063804505, 2.2147242623894026, 3.402742888129529])
# a5 = np.array([3.5223163841807912, 3.243304688518462, 3.1975461330501393, 2.6611137417958752, 2.6547117353593364, 2.469068653255583, 2.6714734756770184, 3.3529020343493725, 2.9993827198563965])

#m=7
# a1=np.array([3.1728813559322036, 3.0934788858615274, 2.6588448617556684, 2.5235698046310273, 2.4998230135755155, 2.1671815886232833, 2.556471760645574, 3.0395475478170586])
# a2=np.array([3.4224105461393597, 3.6466253655449963, 3.0910402662278007, 2.791414202845109, 3.435053735893216, 2.4840227575502922])
# a3=np.array([2.2104990583804143, 2.4774650789726147, 2.58920029027262, 2.6951466738032925, 2.4446844786350796, 2.495994517894664, 2.642982365943635])
# a4 = np.array([3.3416195856873823, 3.0852380398332504, 3.535306387084491, 2.9808675301248346, 2.758525700975597, 2.281386535688561, 3.5100274993633493])
# a5 = np.array([3.5223163841807912, 3.320070991723802, 3.294038465164341, 2.758000025384211, 2.7695548087253123, 2.5238765322766175, 2.769570997288675, 3.4187564847214915, 3.0823683952831065])

#m=8
# a1 = np.array([3.1728813559322036, 3.100000261489016, 2.659962308003649, 2.5155999931277835, 2.4789501598462844, 2.144071174467941, 2.5257458804928947, 3.008136778199294])
# a2 = np.array([3.4224105461393597, 3.6532672754775186, 3.0707111603013386, 2.7230677365216565, 3.4147360249523118, 2.4307075755863163])
# a3=np.array([2.2104990583804143, 2.4734153784112616, 2.5941836286173854, 2.679990639861072, 2.4282459296989365, 2.4520101893873796, 2.5897260453112003])
# a4=np.array([3.3416195856873823, 3.0662518872399542, 3.541504277153278, 2.9661807513036127, 2.7453941205089314, 2.2067865262840782, 3.4430712290769176])
# a5=np.array([3.5223163841807912, 3.3187842990562535, 3.2963029798145795, 2.738313474602253, 2.7628158820907225, 2.419551919042267, 2.7027445639107497, 3.2810395852020173, 2.9732804700783793])

#m=9
# a1 = np.array([3.1728813559322036, 3.116664240976025, 2.675286094927921, 2.5231027455724444, 2.477245537861592, 2.1403304452214296, 2.5188155741704517, 3.00425970841768])
# a2 = np.array([3.4224105461393597, 3.6722795732455142, 3.0723109008909684, 2.6842780847725853, 3.42155849994586, 2.4041726917194213])
# a3 = np.array([2.2104990583804143, 2.4779089708526185, 2.6085564028050063, 2.6840822038139276, 2.4319779120933864, 2.433338805327895, 2.5646065801678404])
# a4 = np.array([3.3416195856873823, 3.0643281440877694, 3.563777613744798, 2.971893673631401, 2.7537372156552498, 2.16101158209754, 3.4148118263063774])
# a5 = np.array([3.5223163841807912, 3.3307688279175807, 3.314494977809377, 2.7388747919543066, 2.7767344592631296, 2.3518564384955374, 2.668223933296938, 3.206941393212293, 2.9092857279797415])

#m=10
# a1 = np.array([3.1728813559322036, 3.13095137812946, 2.6852739218850927, 2.5196911248342753, 2.4573061728918715, 2.1172803535571116, 2.48802700638861, 2.9800037755150526])
# a2 = np.array([3.4224105461393597, 3.69410778151919, 3.0594387302616752, 2.612444295087639, 3.421736492790674, 2.3427279031785417])
# a3 = np.array([2.2104990583804143, 2.47720152410115, 2.620031218841935, 2.6726247177057494, 2.419576157935492, 2.3850680125505455, 2.5054590772744065])
# a4 = np.array([3.3416195856873823, 3.0500906148468587, 3.5874793904327653, 2.9640987071569493, 2.7470392880024215, 2.073856324281498, 3.3819424063031223])
# a5 = np.array([3.5223163841807912, 3.3407176784462713, 3.329402259810794, 2.7223157036364793, 2.7795413247512024, 2.243851652603601, 2.5981855881932243, 3.1451321417359557, 2.8261965334083694])

#m=11
a1 = np.array([3.1728813559322036, 3.142686876274957, 2.692783616321811, 2.5145158148416273, 2.436405821288722, 2.0939051758738083, 2.4569049264456795, 2.9535521277248753])
a2 = np.array([3.4224105461393597, 3.7116263352522885, 3.044015533095141, 2.543499225443588, 3.417137065346072, 2.283834872183051])
a3 = np.array([2.2104990583804143, 2.475732882011592, 2.6295171962375616, 2.6593668525361114, 2.4058033960149428, 2.3380231630368837, 2.4479390873059046])
a4 = np.array([3.3416195856873823, 3.0348336303854673, 3.6063467270036527, 2.953898399224677, 2.737959066335954, 1.9935040317046226, 3.3452634306034277])
a5 = np.array([3.5223163841807912, 3.3477500768514377, 3.3406603949869824, 2.7041509229655056, 2.7797154367221037, 2.1453121304171807, 2.5303219547878806, 3.0813467607051632, 2.7458165267557435])

#m=6, vf=1.5%
a1=np.array([2.7369624885635866, 2.629290626788345, 2.8443438561772596, 2.531624830826824, 3.1291055673278203, 2.3092008681469887, 3.152220504205399, 3.3614421941209613, 4.504062765270546, 3.9658272146314024])

#m=7, vf=1.5%
a1=np.array([2.7369624885635866, 2.667214321197749, 2.9312115626174573, 2.6104876160564605, 3.2083564752593885, 2.404570716473726, 3.1958840723755295, 3.49287821681164, 4.686717407706085, 4.147091365820768])

#m=8, vf=1.5%
a1=np.array([2.7369624885635866, 2.670775366684364, 2.927609672549571, 2.592968282477475, 3.195669904545075, 2.3757633499436994, 3.0605913488968937, 3.4481588699366563, 4.69501288613843, 4.094844969497952])

#m=9, vf=1.5%
a1=np.array([2.7369624885635866, 2.679336341366533, 2.93904846777716, 2.5918469326584326, 3.1963926910323592, 2.3686271862064343, 2.967578249482153, 3.4343143939814182, 4.729021149914169, 4.083627678560239])

#m=10, vf=1.5%
a1=np.array([2.7369624885635866, 2.687207131574117, 2.9427415806649466, 2.57495311010633, 3.1851267334976665, 2.338216802019382, 2.8097249172514696, 3.385753172129508, 4.753463087679256, 4.03154693060879])

#m=11, vf=1.5%
a1=np.array([2.7369624885635866, 2.6937977421755224, 2.944668225456773, 2.557512278821169, 3.1731686354916695, 2.307902180098276, 2.669443394773836, 3.3375558599975097, 4.7704248480196, 3.9777673861246505])


stress_arr = np.array([])
for i in range(5):
    homedir = 'D:\\data\\'
    path = [homedir, 'test'+str(i+1)+'.txt']
    filepath = os.path.join(*path)
    data = np.loadtxt(filepath)
    stress = data[3, :]/2.
    stress_arr = np.hstack((stress_arr, stress))
    
sig_m = 25e3*stress_arr/(0.01*180e3+25e3*0.99)


a = np.hstack((a1, a2, a3, a4, a5))

bin_arr = np.linspace(0.0, 11.0, 45)

hist, bins = np.histogram(a, bins=bin_arr)
hist1, bins1 = np.histogram(sig_m, bins=bin_arr)



width = 0.7 * (bins[1] - bins[0])
center = (bins[:-1] + bins[1:]) / 2
plt.hist(a, bin_arr, label='crack bridge')
plt.hist(sig_m, bin_arr, label='mixture rule')
# plt.bar(center, hist, align='center', width=width)
# plt.bar(center, hist1, align='center', width=width)
plt.xlabel('matrix stress[MPa]')
plt.legend()
plt.show()




# print range(np.sum(a==0)+1)